(function($){$.fn.jstree=function(options){$(this).each(function(){$(this).tree(options);});return $(this);}})($);(function($){$.fn.tree=function(options){options=$.extend({multiExtend:true,collapseOthers:false,onClick:function(obj){},dblclick:false,animation:true},options);var obj=$(this);if($(this).children("li").length<=0&&options.async instanceof Object){$.ajax({async:false,type:(options.type=="post"?"get":"get"),url:options.async.url,data:options.async.data,error:function(error){alert("İstek Gerçekleştirilemedi !");},success:function(data){obj.children("span:first").remove();if($(data).find("list:first-child").length>0){if($(data).find("list:first-child").children("item").length>0){var ul=$("<ul />").hide();xml2node(data,ul);ul.appendTo(obj).slideDown(200);ul.tree(options);}}}});}else{$(this).find("ul").hide();$(this).find("li").children("div,span,a").not(".selected").hover(function(){$(this).css({background:"#BBDDFF",cursor:"pointer"})},function(){$(this).css({background:"",cursor:"none"})});if($(this).children("li").length>0){$(this).children("li").each(function(){if($(this).find("li").length>0){$(this).attr("class","directory_collapsed");$(this).children("ul").tree(options);}else{$(this).attr("class","file");}var clickEvent=options.dblclick==true?"dblclick":"click";if($(this).children(":first").length>0){$(this).children(":first").bind(clickEvent,function(){obj=$(this);var parentNodes=$(this).parents("li").children(":first-child").map(function(){return $(this).text()}).get().reverse();if(options.onClick instanceof Function){var fnc=options.onClick($(this),parentNodes);if(fnc==true||fnc==false){return fnc;}}if($(this).siblings("ul").length<=0&&options.async instanceof Object&&$(this).parent().attr("lang")!="0"){options.async.data.path=parentNodes.join("/");$(this).hide();$("<span />").html("<img src='../images/loader.gif' style='vertical-align:middle' \/>&nbsp;Yükleniyor").appendTo(obj.parent());$.ajax({async:false,type:(options.async.type=="post"?"get":"get"),url:options.async.url,data:options.async.data,error:function(){alert("İstek Gerçekleştirilemedi !");},success:function(data){obj.siblings("span:first").remove();obj.show();if($(data).find("list").length>0){if($(data).find("list").children("item").length>0){var ul=$("<ul />").hide();xml2node(data,ul);ul.appendTo(obj.parent());ul.tree(options);}}}});}if($(this).siblings("ul:first").length>0){render($(this),options);}});}});}}return $(this);}})($);function xml2node(data,parent){if($(data).find("list:first").children("item").length>0){$(data).find("list:first").children("item").each(function(){var li=$("<li "+($(this).attr("async")=="0"?"lang='0'":"")+" />").html("<div>"+$(this).children("label").text()+"</div>").appendTo(parent);if($(this).find("list:first").length>0){xml2node($(this).get(),$("<ul />").hide().appendTo(li));}});}}function render(obj,options){if(options.multiExtend==false){if(options.animation==false){obj.parent().siblings("li").children("ul:eq(0)").hide();}else{obj.parent().siblings("li").children("ul:eq(0)").slideUp(200);}obj.parent().siblings("li[class='directory_expanded']").attr("class","directory_collapsed");}else if(options.collapseOthers==true){if(options.animation==false){obj.parents("ul:last").find("ul").not(obj.parents("ul")).not(obj.siblings("ul")).not(obj.parent().find("ul")).hide();}else{obj.parents("ul:last").find("ul").not(obj.parents("ul")).not(obj.siblings("ul")).not(obj.parent().find("ul")).slideUp(300);}obj.parents("ul:last").find("li[class='directory_expanded']").not(obj.parents("li")).not(obj.parent().find("li")).attr("class","directory_collapsed");}if(options.animation==false){obj.siblings("ul").toggle();if(obj.siblings("ul").css("display")=="none"){obj.parent().attr("class","directory_collapsed");obj.attr("class","");}else{obj.parent().attr("class","directory_expanded");obj.attr("class","selected");}}else{var state=obj.siblings("ul").css("display");if(state=="none"){obj.parent().attr("class","directory_expanded");obj.parents("ul:last").find(".selected").not(obj).attr("class","");obj.attr("class","selected");}else{obj.parent().attr("class","directory_collapsed");obj.attr("class","");}obj.siblings("ul").slideToggle(200);}}